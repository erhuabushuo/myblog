Title: 数据挖掘指南：八、余弦相似度
Date: 2016-08-23 11:55
Category: Data Mining

我们来看另一个公式：余弦相似度。它在文本挖掘中应用较多，在协同过滤中也会使用到。

## 看看数据

这里记录了每个用户播放歌曲的次数，我们用这些数据进行推荐：

![](http://i2.buimg.com/1949/2903df1feba5f86e.png)

简单扫一眼（或者用之前的距离计算公式），我们可以发现Ann的偏好和Sally更为相似。

## 问题在哪儿？


单个用户数据是稀疏的，例如可能我听过的歌曲，你没有从没有听过。一品梅我可能听了25次，你一次也没有播放过，
总体中的非零值相当少。

类似，例如我们要找两篇文档的相似度时，英语有超过100万个单词，但文章可能仅有6000多个不同单词，非零值就非常稀少。

## 解决

余弦相似度的计算中会略过这些非零值。它的计算公式是：

![](http://i2.buimg.com/1949/7d7c2d09a9c00f64.png)

其中，"·"号表示数量积。"||x||"表示向量x的模，计算公式是：

![](http://i2.buimg.com/1949/017ae61be3612541.png)

我们用上文中“偏好完全一致”的示例：

![](http://i4.buimg.com/1949/b119b2921efea8ef.png)

所以两个向量为：

![](http://i1.buimg.com/1949/822a3f8305d6db48.png)

它们的模是：

![](http://i4.buimg.com/1949/4c15dd7d6f4227d1.png)

数量积的计算：

![](http://i2.buimg.com/1949/d30516f7fbbe7bb8.png)

因此余弦相似度是：

![](http://i2.buimg.com/1949/7b9aa4a676341121.png)

余弦相似度的范围从1到-1,1标识完全匹配，-1表示完全相悖。所以0.935标识匹配度很高。



