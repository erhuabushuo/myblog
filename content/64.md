Title: Twisted Howto: 编写服务端
Date: 2016-10-11 11:55
Category: Twisted

本文阐述如何使用Twisted来实现TCP网络服务器

## 概览

协议(Protocol)处理通常作为**twisted.internet.protocol.Protocol**子类。大部分协议处理器都是继承该类或其子类。每个连接都会实现里化该协议类，一经申请，在连接结束后释放。意味着持久化配置不存储在**Protocol**

持久化配置保存在**Factory**类，通常继承至**twisted.internet.protcol.Factory**.
Factory的**buildProtocol**方法用来为每个连接创建**Protocol**实例。

通常在多个端口或网络地址提供相同服务非常有用。这就是为什么Factory没能监听连接，事实上它不指导任何关于网络的相关。

## Protocols

Twisted的协议处理使用异步方式。协议响应网络到达事件并调用处理方法。

以下是个简单示例:


  from twisted.internet.protocol import Protocol

  class Echo(Protocol):

      def dataReceived(self, data):
          self.transport.write(data)

这是最简单的protcol示例。它将所有收到的内容写回，并没有处理所有的事件。以下是处理另一个事件示例：


  from twisted.internet.protocol import Protcol

  class QOTD(Protcol):

      def connectionMade(self):
          self.transport.write(b"An apple a day keeps the doctor aywa\r\n")
          self.transport.loseConnection()
